## 功能

1　下载文章（不下载图片，适用于修改文章后再次上传）

2　下载文章（下载全部图片，适用于本地的备份）

3　下载文章（图片以base64形式2写入md文件，便于分享）　#TODO

4　上传全新文章（数据库中不存在）

5　上传修改文章（数据库中存在）

6　删除文章

7　移动文章（所属分类）

8　创建分类

9　删除目录　#TODO 

## 依赖

requests，pymysql

## 实现思路

对于大部分操作，都是通过pymysql直接对数据库进行远程操作，但是图片的上传和创建目录是通过post传值的方式实现的。图片上传为了安全考虑，没有通过ftp传输；而创建目录是因为数据库的typecho_metas表中的order列无法进行数据修改，迫不得已。

原来想做GUI的，后来不耐烦了，鸽了。先将就用吧。寒假我打算写个笔记软件，到时候顺便将这个需求直接整合到笔记软件上吧，就不额外写了。

## 一些弯路

我一开始想全部通过数据库修改实现，但后来脑子转过弯来了，醒悟若真这么做了，岂不是相当于自己写了python的后端？？

最简单的做法，应该是能通过post传的就用post传，这样只需要将数据提交，数据库的写入由网站的后端操作，可以避免自己写的数据库操作出bug。而对于数据入库后的信息，比如新建文章的cid，可以自己用pymysql获取具体的值。二者相结合，效率更高，bug也会少很多。

然而还是醒悟晚了，导致我看我的程序，简直就像看shit一样。。。

## 文件介绍

**operation.py** 程序入口，操作都在这里面进行

**PyMySQL.py** 对数据库的增删改查进行针对性的封装

**post.py** post传值

**pic.py** 有关图片的操作

**blogs_settings.py** 配置文件

## 使用前必做

typecho是带有token的，token由四部分组成，分别为长度为32的字符串（建站时初始化，之后不变），长度为32的字符串authCode（每次登录时随机化），user的id，一般admin为1，具体页面的referer。四部分以&连接，然后md5作为token。

我们需要手动获取token1，token2和3连接数据库后程序自动获取，token4也已经写在程序里了。

### 获取token1





## 已知bug

`![](D:\图片\喜欢\ゞ静侞処Ζīoо(1905图)_@sZmnRcdI收集_花瓣美女907377431.jpg)`

图片名称中含有（），导致正则匹配不到正确的图片地址，实在想不到解决的方案

## 时间线

20190904　　第一次上传

